<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>e87509b0043b4905bb68ac3e985b65e7</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="65be189a-b9c8-4cd6-ad28-fa8c8157d3a3" class="cell code"
data-execution_count="1">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>reload_ext autoreload</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span></span></code></pre></div>
</div>
<div id="40886540-8dc1-4a28-828a-10c9067e68fb" class="cell markdown">
<h1 id="imports">Imports</h1>
</div>
<div id="85931bda-6a22-41fb-9125-9b751485adfa" class="cell markdown">
<h2 id="third-party-imports">Third party imports</h2>
</div>
<div id="aa4f70e8-c6fc-461b-90d9-2b8a196678c0" class="cell code"
data-execution_count="2">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
<div id="d2f644a0-8c45-4d64-aa9b-5225b2056539" class="cell code"
data-execution_count="3">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>num_clusters <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mean_range <span class="op">=</span> (<span class="dv">40</span>,<span class="dv">50</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>cov_range <span class="op">=</span> (<span class="dv">0</span>,<span class="fl">0.2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>max_points <span class="op">=</span> <span class="dv">100</span></span></code></pre></div>
</div>
<div id="ef7223b9-92c1-4c3e-8fff-4526accad37d" class="cell code"
data-execution_count="4">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> []</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">49</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cluster_id <span class="kw">in</span> <span class="bu">range</span>(num_clusters):</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> np.random.uniform(mean_range[<span class="dv">0</span>], mean_range[<span class="dv">1</span>], size<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.diag(np.random.uniform(cov_range[<span class="dv">0</span>], cov_range[<span class="dv">1</span>], size<span class="op">=</span><span class="dv">2</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    n_points <span class="op">=</span> <span class="bu">int</span>(np.random.uniform(<span class="bu">int</span>(max_points <span class="op">/</span> <span class="dv">2</span>), max_points))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    cluster_data <span class="op">=</span> np.random.multivariate_normal(mean, cov, n_points)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    data.append(cluster_data)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    labels.extend([cluster_id] <span class="op">*</span> n_points)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.vstack(data)</span></code></pre></div>
</div>
<div id="e015b52d-bfe7-48df-9be7-f04f87b87542" class="cell code"
data-execution_count="5">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))  </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">&quot;Random Clusters without colors&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">&quot;X-axis&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">&quot;Y-axis&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> axes[<span class="dv">1</span>].scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], c<span class="op">=</span>labels, cmap<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">&quot;Random Clusters with colors&quot;</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">&quot;X-axis&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">&quot;Y-axis&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/ef86a59dd742ac59b7fd3b69436e4d13f5e6c004.png" /></p>
</div>
</div>
<div id="a59dd2ed-2e24-4f35-81da-ce1f46bc468c" class="cell markdown">
<h1 id="setup-data">Setup data</h1>
</div>
<div id="6870c794-1555-4a01-bfc2-a350aa61fa6f" class="cell code"
data-execution_count="6">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>num_clusters <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mean_range <span class="op">=</span> (<span class="dv">1</span>,<span class="dv">15</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>cov_range <span class="op">=</span> (<span class="dv">0</span>,<span class="fl">0.8</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>max_points <span class="op">=</span> <span class="dv">100</span></span></code></pre></div>
</div>
<div id="a7feabd9-a8af-4da2-beec-94432749c86d" class="cell code"
data-execution_count="7">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> []</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> cluster_id <span class="kw">in</span> <span class="bu">range</span>(num_clusters):</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    mean <span class="op">=</span> np.random.uniform(mean_range[<span class="dv">0</span>], mean_range[<span class="dv">1</span>], size<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.diag(np.random.uniform(cov_range[<span class="dv">0</span>], cov_range[<span class="dv">1</span>], size<span class="op">=</span><span class="dv">2</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    n_points <span class="op">=</span> <span class="bu">int</span>(np.random.uniform(<span class="bu">int</span>(max_points <span class="op">/</span> <span class="dv">2</span>), max_points))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    cluster_data <span class="op">=</span> np.random.multivariate_normal(mean, cov, n_points)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    data.append(cluster_data)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    labels.extend([cluster_id] <span class="op">*</span> n_points)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.vstack(data)</span></code></pre></div>
</div>
<div id="b75d5f5d-72e2-40e5-8d71-159089fa089d" class="cell code"
data-execution_count="8">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))  </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">&quot;Random Clusters without colors&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">&quot;X-axis&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">&quot;Y-axis&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].grid(<span class="va">True</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>scatter <span class="op">=</span> axes[<span class="dv">1</span>].scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], c<span class="op">=</span>labels, cmap<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">&quot;Random Clusters with colors&quot;</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">&quot;X-axis&quot;</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">&quot;Y-axis&quot;</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].grid(<span class="va">True</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/232f5f7ad312f978b994176cd5641edb5f5719bd.png" /></p>
</div>
</div>
<div id="2cee9d07-0b30-47dd-bafe-3b3a627d7e37" class="cell markdown">
<h1 id="clustering-with-k-means">Clustering with k-means</h1>
</div>
<div id="d2198fdb-79d7-4cff-9fd0-1257ed3d2e11" class="cell code"
data-execution_count="9">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial <span class="im">import</span> Voronoi, voronoi_plot_2d</span></code></pre></div>
</div>
<div id="d938b575-0987-4eeb-b104-ce1e0de99c93" class="cell markdown">
<h2 id="voronoi-tesellation">Voronoi Tesellation</h2>
</div>
<div id="2bc0c258-64f3-47d5-ba8a-5c5a26b68b2f" class="cell code"
data-execution_count="13">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_voronoi(km, cluster_colors <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    vor <span class="op">=</span> Voronoi(km.cluster_centers_)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>),dpi<span class="op">=</span><span class="dv">150</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    voronoi_plot_2d(vor, show_vertices<span class="op">=</span><span class="va">False</span>, line_colors<span class="op">=</span><span class="st">&#39;orange&#39;</span>, line_width<span class="op">=</span><span class="dv">2</span>, line_alpha<span class="op">=</span><span class="fl">0.6</span>, point_size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot data points</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> cluster_colors:</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        plt.scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], c<span class="op">=</span>km.labels_, cmap<span class="op">=</span><span class="st">&#39;tab10&#39;</span>, s<span class="op">=</span><span class="dv">20</span>, label<span class="op">=</span><span class="st">&#39;Data points&#39;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(optimal_k):</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            cluster_points <span class="op">=</span> X[labels <span class="op">==</span> i]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>            plt.scatter(cluster_points[:, <span class="dv">0</span>], cluster_points[:, <span class="dv">1</span>], c<span class="op">=</span>[cluster_colors[i]], s<span class="op">=</span><span class="dv">20</span>, label<span class="op">=</span><span class="ss">f&quot;Cluster </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot cluster centers</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    plt.scatter(km.cluster_centers_[:, <span class="dv">0</span>], km.cluster_centers_[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">&#39;red&#39;</span>, marker<span class="op">=</span><span class="st">&#39;X&#39;</span>, s<span class="op">=</span><span class="dv">100</span>, label<span class="op">=</span><span class="st">&#39;Cluster centers&#39;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add labels and legend</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;Voronoi Tessellation with KMeans Clusters&quot;</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&quot;X-axis&quot;</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&quot;Y-axis&quot;</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    plt.xlim(<span class="dv">0</span>, <span class="dv">16</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    plt.ylim(<span class="dv">4</span>, <span class="dv">18</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
</div>
<div id="ccf91188-b2cc-488b-825f-9f7d7eda40d3" class="cell markdown">
<h2 id="bad-choices">Bad choices</h2>
</div>
<div id="8f490344-2b8a-44b8-ab78-24ca7a7544c2" class="cell markdown">
<h3 id="n_init--1-n_clusters--4">N_init = 1, N_clusters = 4</h3>
</div>
<div id="29bd3327-8968-496d-b9ad-c292b93c785e" class="cell markdown">
<p>Cuando la K es muy pequeña, clusters claramente separados tienden a
unirse</p>
</div>
<div id="ef727a39-940f-48ea-b266-5210d919213a" class="cell code"
data-execution_count="14">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>km_1_4 <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">4</span>, n_init <span class="op">=</span> <span class="dv">1</span>, max_iter <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>            init <span class="op">=</span> <span class="st">&#39;random&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit(X)</span></code></pre></div>
</div>
<div id="352e1cf1-50b9-4214-86f6-7a4fff132034" class="cell code"
data-execution_count="15">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plot_voronoi(km_1_4)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;Figure size 1800x1800 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/4e84e56dbe5f9bcffb2e9ab4a8a482b1c74738f0.png" /></p>
</div>
</div>
<div id="925acc8c-3048-488c-acd5-7ecc6917ba73" class="cell code">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="0c6bb6b2-eac7-429a-8d79-caf91aef8d0f" class="cell markdown">
<h3 id="n_init--1-n_clusters--12">N_init = 1, N_clusters = 12</h3>
</div>
<div id="b4e349ae-c813-4867-a36b-8a6f1331fca0" class="cell markdown">
<p>Cuando la K es muy grande, clusters claramente delimitados se dividen
en varios</p>
</div>
<div id="c3732aae-1c60-4fd0-98a5-f75994240f31" class="cell code"
data-execution_count="16">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>km_1_12 <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">12</span>, n_init <span class="op">=</span> <span class="dv">1</span>, max_iter <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>            init <span class="op">=</span> <span class="st">&#39;random&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit(X)</span></code></pre></div>
</div>
<div id="7a8d3c71-d262-460a-88b1-f2e20e002e5d" class="cell code"
data-execution_count="17">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plot_voronoi(km_1_12)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;Figure size 1800x1800 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/104335e44decd1f388818a4e8ed51f24d7ece85b.png" /></p>
</div>
</div>
<div id="0b725529-cd14-43ef-8076-55bd040fe205" class="cell markdown">
<h2 id="good-choices-for-k">Good choices for K</h2>
</div>
<div id="c8ff541a-54f3-4b91-ba23-f8a0ec08938f" class="cell markdown">
<h3 id="n_init--1-n_clusters--6">N_init = 1, N_clusters = 6</h3>
</div>
<div id="47109108-be72-46d1-a64c-0babe87f95a7" class="cell code"
data-execution_count="18">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>km_1_6 <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">6</span>, n_init <span class="op">=</span> <span class="dv">1</span>, max_iter <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>            init <span class="op">=</span> <span class="st">&#39;random&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit(X)</span></code></pre></div>
</div>
<div id="e1787418-9691-4fd9-acf2-c99a481db173" class="cell markdown">
<p>Podemos ver que al hacer solo una iteración el resultado no es muy
bueno ya que es facil ver que el cluster pintado de color verde son
realmente dos clusters. Como la función que optimiza k-means es no
convexa tiene varios mínimos locales. Este es uno de ellos. Para poder
encontrar el máximo local deberiamos ejecutar muchas veces el algoritmo
con difenrentes inicializaciones.</p>
</div>
<div id="44ef15f1-feba-4e90-a9cf-470702186640" class="cell code"
data-execution_count="19">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_voronoi(km_1_6)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;Figure size 1800x1800 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/33c4d3d6ed5c5e2d013c12dc9e08b010950aa72f.png" /></p>
</div>
</div>
<div id="abfd152a-1cb9-4dcb-a911-41f8ed662c22" class="cell markdown">
<h3 id="n_init--100-n_clusters--6">N_init = 100, N_clusters = 6</h3>
</div>
<div id="7a5ba65e-0034-4d72-959b-bddc9a6a0ff0" class="cell markdown">
<p>Esto tiene mucho mas sentido, para alguien que desconoce el origen de
los datos, estos grupos parecen correctos.</p>
</div>
<div id="97773e35-3521-4f7d-b892-1483613eab32" class="cell code"
data-execution_count="20">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>km_100_6 <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">6</span>, n_init <span class="op">=</span> <span class="dv">100</span>, max_iter <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>            init <span class="op">=</span> <span class="st">&#39;random&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit(X)</span></code></pre></div>
</div>
<div id="a12731b2-cea7-47a7-859e-9342a671624f" class="cell code"
data-execution_count="21">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plot_voronoi(km_100_6)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;Figure size 1800x1800 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/b2b1fd6e4da18d292cf40f3c4c5974ee17f5c8e8.png" /></p>
</div>
</div>
<div id="004832da-3cc5-4f03-a4c1-ab01e1486a57" class="cell markdown">
<h2 id="finding-the-optimal-k">Finding the optimal K</h2>
</div>
<div id="18ae9b13-1f8c-4fc0-9015-877bba2b9572" class="cell markdown">
<h3 id="by-inertia">By inertia</h3>
</div>
<div id="8cc09ef7-ef42-4b2e-aa36-788135004170" class="cell code"
data-execution_count="22">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>wss <span class="op">=</span> np.zeros(<span class="dv">8</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>):</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k<span class="op">+</span><span class="dv">1</span>, n_init <span class="op">=</span> <span class="dv">20</span>, max_iter<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>            init <span class="op">=</span> <span class="st">&#39;random&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit(X)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    wss[k] <span class="op">=</span> kmeans.inertia_ </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.arange(<span class="dv">8</span>)<span class="op">+</span><span class="dv">1</span>, wss)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>plt.plot(np.arange(<span class="dv">8</span>) <span class="op">+</span> <span class="dv">1</span>, wss, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>, label<span class="op">=</span><span class="st">&#39;Connecting line&#39;</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Total within clusters sum of squares&quot;</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/83425bcef7e89454ccc0a0a9a110586f8d17f0c0.png" /></p>
</div>
</div>
<div id="9259128f-2c5c-42b3-82d6-a520d9b4d768" class="cell markdown">
<h3 id="by-silhoutte">By silhoutte</h3>
</div>
<div id="e1016295-131a-47a9-8409-ecb586999c10" class="cell code"
data-execution_count="23">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> silhouette_score, silhouette_samples</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>asw <span class="op">=</span> np.zeros(<span class="dv">9</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">10</span>):</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k<span class="op">+</span><span class="dv">1</span>, n_init <span class="op">=</span> <span class="dv">20</span>, max_iter<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                  init <span class="op">=</span> <span class="st">&#39;random&#39;</span>, random_state<span class="op">=</span><span class="dv">2</span>).fit(X)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  asw[k<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> silhouette_score(X, kmeans.labels_)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plt.clf()    </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(np.arange(<span class="dv">1</span>,<span class="dv">10</span>)<span class="op">+</span><span class="dv">1</span>, asw)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>plt.plot(np.arange(<span class="dv">9</span>)<span class="op">+</span><span class="dv">2</span>, asw, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>, color<span class="op">=</span><span class="st">&#39;orange&#39;</span>, label<span class="op">=</span><span class="st">&#39;Connecting line&#39;</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Average Silhouette Width&quot;</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/80dbb5276a5c371da68569169c9694844559b322.png" /></p>
</div>
</div>
<div id="be3cd1d2-a02d-42ca-8b94-db31fd713a7c" class="cell code"
data-execution_count="24">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> colormaps</span></code></pre></div>
</div>
<div id="a4deaea2-e25b-46cb-b00e-aa54b70aca0b" class="cell code"
data-execution_count="28">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>optimal_k <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> plt.get_cmap(<span class="st">&quot;tab10&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>cluster_colors <span class="op">=</span> [cmap(i <span class="op">%</span> <span class="dv">10</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(optimal_k)]  <span class="co"># Lista de colores</span></span></code></pre></div>
</div>
<div id="aef8ee27-bd9a-4823-8ed2-05c21c283b72" class="cell code"
data-execution_count="31">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> km_100_6</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> kmeans.labels_</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular valores de silueta para cada punto</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>silhouette_vals <span class="op">=</span> silhouette_samples(X, labels)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> colormaps[<span class="st">&quot;tab10&quot;</span>]</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear Silhouette Plot</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>y_lower <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(optimal_k):</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filtrar valores de silueta por cluster</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    cluster_silhouette_vals <span class="op">=</span> silhouette_vals[labels <span class="op">==</span> i]</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    cluster_silhouette_vals.sort()</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    y_upper <span class="op">=</span> y_lower <span class="op">+</span> <span class="bu">len</span>(cluster_silhouette_vals)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dibujar barras horizontales</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    plt.barh(<span class="bu">range</span>(y_lower, y_upper), cluster_silhouette_vals, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>, color<span class="op">=</span>cluster_colors[i], height<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="ss">f&#39;Cluster </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    y_lower <span class="op">=</span> y_upper</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Línea de referencia para la media del coeficiente de silueta</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>avg_silhouette <span class="op">=</span> np.mean(silhouette_vals)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>plt.axvline(avg_silhouette, color<span class="op">=</span><span class="st">&quot;red&quot;</span>, linestyle<span class="op">=</span><span class="st">&quot;--&quot;</span>, label<span class="op">=</span><span class="ss">f&#39;Avg Silhouette: </span><span class="sc">{</span>avg_silhouette<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuración del gráfico</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Silhouette Plot for Optimal Clustering&quot;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Silhouette Coefficient Values&quot;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Clustered Data Points&quot;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>plt.yticks([])  <span class="co"># Ocultar ticks del eje Y</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">&#39;best&#39;</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/cbb290d2b365c3a0666c7b89272effb9316c64ac.png" /></p>
</div>
</div>
<div id="b1b9761c-a57b-4085-8729-aa1d8b7f257f" class="cell code"
data-execution_count="30">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>plot_voronoi(km_100_6,cluster_colors)</span></code></pre></div>
<div class="output display_data">
<pre><code>&lt;Figure size 1800x1800 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/0fc9dc6f7d7d257a986679289e318fa65b794911.png" /></p>
</div>
</div>
<div id="a450f866-d572-4483-86c1-4a29fe689362" class="cell markdown">
<h1 id="image-reduction-with-k-means">Image reduction with k-means</h1>
</div>
<div id="cd90644a-59cd-4c19-800d-6a813744d206" class="cell markdown">
<h2 id="load-the-image">Load the image</h2>
</div>
<div id="13e40397-7559-4921-ad76-9b893b266dbe" class="cell code"
data-execution_count="32">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> imageio.v2 <span class="im">as</span> imageio</span></code></pre></div>
</div>
<div id="c387b775-d4e6-46e1-b0ad-b784845e4969" class="cell code"
data-execution_count="33">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> imageio.imread(<span class="st">&#39;./img/f1_max.jpg&#39;</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(image)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Original Image&quot;</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/c31008754db8d3895af088846b5ef594d300c616.png" /></p>
</div>
</div>
<div id="4b80d3d5-51e4-467a-91c2-73581dc9bc71" class="cell markdown">
<h2 id="convert-the-image-into-a-rgb-matrix">Convert the image into a
RGB matrix</h2>
</div>
<div id="764d0d95-de6d-41ee-91dd-227400bcd7ac" class="cell code"
data-execution_count="34">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pixels <span class="op">=</span> image.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="55eb2013-f70d-4798-a8da-2817f376d4e3" class="cell code"
data-execution_count="35">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pixels[:<span class="dv">5</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[[131 150  60]
 [128 147  57]
 [132 153  62]
 [134 155  64]
 [126 149  58]]
</code></pre>
</div>
</div>
<div id="c1774fd1-d2a7-42de-aa99-4a39518cef40" class="cell markdown">
<h2 id="apply-k-means-to-cluster-pixels-by-color">Apply k-means to
cluster pixels by color</h2>
</div>
<div id="632a40b1-2417-4673-b05e-db456c1d69e1" class="cell code"
data-execution_count="36">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>km_image <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">4</span>, n_init <span class="op">=</span> <span class="dv">100</span>, max_iter <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>            init <span class="op">=</span> <span class="st">&#39;random&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit(pixels)</span></code></pre></div>
</div>
<div id="d049812b-a799-4fda-9191-fcfd91a47371" class="cell code"
data-execution_count="37">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>np.unique(km_image.labels_)</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">
<pre><code>array([0, 1, 2, 3])</code></pre>
</div>
</div>
<div id="666ad26d-78d0-4909-89b1-eb0d868f6efb" class="cell code"
data-execution_count="38">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>km_image.cluster_centers_</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<pre><code>array([[232.75308354, 217.50503367, 185.43409561],
       [ 19.68062165,  19.23438335,  23.22971993],
       [144.20697832, 143.57738791, 139.43506076],
       [131.94682067, 157.0236822 ,  64.49779331]])</code></pre>
</div>
</div>
<div id="f12e709d-6bb3-448c-baa7-119202ac6a2a" class="cell code"
data-execution_count="39">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>compressed_pixels <span class="op">=</span> np.array([km_image.cluster_centers_[label] <span class="cf">for</span> label <span class="kw">in</span> km_image.labels_])</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>compressed_pixels <span class="op">=</span> compressed_pixels.reshape(image.shape).astype(<span class="st">&#39;uint8&#39;</span>)</span></code></pre></div>
</div>
<div id="3a7a7854-b0df-4d32-aed7-ab8569d8faa7" class="cell code"
data-execution_count="40">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(compressed_pixels)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Reduced Image&quot;</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/f6503f5db6d73968cd47c8c795b8263faef23ee9.png" /></p>
</div>
</div>
<div id="bd168a48-9355-4a92-aeb8-03bf31ac77d5" class="cell markdown">
<h3 id="color-grid">Color grid</h3>
</div>
<div id="9c730fca-e066-4f38-b5d3-9a9e98db66e4" class="cell code"
data-execution_count="41">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>n_colors <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.ravel()  </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, n <span class="kw">in</span> <span class="bu">enumerate</span>(n_colors):</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    km_image <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>n, n_init<span class="op">=</span><span class="dv">10</span>, max_iter<span class="op">=</span><span class="dv">300</span>, random_state<span class="op">=</span><span class="dv">42</span>).fit(pixels)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    compressed_pixels <span class="op">=</span> np.array([km_image.cluster_centers_[label] <span class="cf">for</span> label <span class="kw">in</span> km_image.labels_])</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    compressed_pixels <span class="op">=</span> compressed_pixels.reshape(image.shape).astype(<span class="st">&#39;uint8&#39;</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    axes[i].imshow(compressed_pixels)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    axes[i].axis(<span class="st">&#39;off&#39;</span>)  <span class="co"># Ocultar ejes</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(<span class="ss">f&quot;</span><span class="sc">{</span>n<span class="sc">}</span><span class="ss"> Colors&quot;</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar diseño</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&quot;KMeans Compressed Images with Different Colors&quot;</span>, fontsize<span class="op">=</span><span class="dv">16</span>, y<span class="op">=</span><span class="fl">1.02</span>)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_04e626805b5c48fb93b00607604a98cf/a5bfd269ea159d7cd5e21981f245e78322fd67ed.png" /></p>
</div>
</div>
<div id="2787857b-fba1-4d0f-9500-d767d407558d" class="cell code">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="52beeeef-ac4b-4819-916d-ea95a2a5ddcc" class="cell code">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="0e36e7b1-eaaf-4772-9017-186fb1fe1de6" class="cell code">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="cee256d5-ac5e-4d79-b85f-cc7ba5098888" class="cell code">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="6effa8eb-38a3-42a0-a9cc-43b6a15db9b9" class="cell code">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="9545ac45-3ca8-41d8-9af7-5f6aac8b75da" class="cell code">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="edae1db8-5cf0-48d7-b407-b2beb152ead9" class="cell code">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="1a1f4809-3f59-43fc-a934-bd150b197e51" class="cell code">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="d6a2e3b0-140c-4d6a-aed0-abc1238fd211" class="cell code">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="f8678c82-d4ff-482a-915e-86a07dcce609" class="cell code">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="822c4932-7fee-40f2-ad77-c50581031efa" class="cell code">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="3673dd93-b3ca-4bd7-97eb-06a58a73eaeb" class="cell code">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="f3233c1b-9afd-4bcb-9a67-bf644fa35232" class="cell code">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="bea17ca4-af83-41df-bd07-7d6bfd6ac0d1" class="cell code">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div id="3de3f843-4dfc-4087-8c0c-2d9dc259413c" class="cell code">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
